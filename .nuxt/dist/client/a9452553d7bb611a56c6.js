(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{218:function(t,e,o){var content=o(241);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("c185e66a",content,!0,{sourceMap:!1})},220:function(t,e,o){var content=o(431);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("94b49164",content,!0,{sourceMap:!1})},222:function(t,e,o){var content=o(435);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("44cba0d8",content,!0,{sourceMap:!1})},240:function(t,e,o){"use strict";var n=o(218);o.n(n).a},241:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,'[data-v-1268941a]:root{--text-color:red}.article-item[data-v-1268941a]{padding:10px 20px;width:100%;cursor:pointer;position:relative;border-bottom:1px solid #000}.article-item .article-item-title[data-v-1268941a]{font-size:17px;color:#ddd}.article-item .article-item-mark[data-v-1268941a]{margin-top:7px;font-size:12px}.article-item .operate-icon[data-v-1268941a]{width:30px;height:30px;border-radius:50%;right:7px;top:7px;position:absolute;z-index:1;background:#5f5f5f;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:.3s;text-align:center;line-height:30px;color:#19181d}.article-item .operate-icon .iconfont[data-v-1268941a]{font-size:18px}.article-item .operate-icon[data-v-1268941a]:hover{background:#f4606c;color:#fff}.article-item:hover .operate-icon[data-v-1268941a]{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.article-item.act[data-v-1268941a]{background:#19181d}.article-item.act[data-v-1268941a]:after{content:"";position:absolute;width:4px;height:100%;left:0;top:0;background:#afb0b1}.article-layout[data-v-1268941a]{padding:15px 0;background:#202020;color:#919191;max-width:500px;transition:.3s}.article-layout .article-min-width[data-v-1268941a]{min-width:200px}.article-layout.hidden-article[data-v-1268941a]{max-width:0;overflow:hidden}.article-layout-input-box[data-v-1268941a]{background:#5f5f5f;color:#ddd;width:90%;height:40px;padding:0 10px;position:relative;margin:0 auto 10px}.article-layout-input-box .iconfont[data-v-1268941a]{display:block;position:absolute;right:10px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.article-layout-input[data-v-1268941a]{height:100%;border:none;background:transparent;display:inline-block;color:#ddd;outline:#fff;padding-right:46px}.article-label[data-v-1268941a]{margin:7px 0}.article-label-item[data-v-1268941a]{display:inline-block;padding:2px 5px;background:#5f5f5f;color:#202020;border-radius:2px;margin-bottom:3px;font-size:12px}.article-item-box[data-v-1268941a]{overflow-y:auto;overflow-x:hidden}.shortcut-add-layout[data-v-1268941a]{position:absolute;bottom:10px;right:10px;border:1px solid red;z-index:5;width:50px;height:50px;cursor:pointer}',""])},430:function(t,e,o){"use strict";var n=o(220);o.n(n).a},431:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,"[data-v-63c5943d]:root{--text-color:red}.article-layout[data-v-63c5943d]{background:#eee;position:relative}.article-layout .form-label-layout[data-v-63c5943d]{width:100%;text-align:left;font-size:12px;color:#adabab;padding-left:0}.article-layout .form-content-layout[data-v-63c5943d]{background:#fff;padding:7px 20px}.article-layout .add-options-item[data-v-63c5943d]{margin:5px}.article-layout .form-input[data-v-63c5943d],.article-layout .from-select[data-v-63c5943d]{border:none;outline:none;padding:0}.article-layout .form-group[data-v-63c5943d]:not(:first-child){margin:0}.article-layout .form-content-layout-select[data-v-63c5943d]{padding-top:18px;padding-bottom:18px}.article-layout .markdown-layout[data-v-63c5943d]{min-height:500px;position:relative;padding:10px}.article-layout-theme1 .article-content[data-v-63c5943d]{padding:40px}.article-layout-theme1 .form-label-layout[data-v-63c5943d]{display:none}.article-layout-theme1 .form-input[data-v-63c5943d],.article-layout-theme1 .from-select[data-v-63c5943d]{border:none;outline:none;font-size:20px}.article-title[data-v-63c5943d]{border-bottom:1px solid #e1e4e8;background:#fff;height:45px;line-height:45px;padding:0 15px}.article-title .operate-list-operate .iconfont[data-v-63c5943d]{font-size:20px;cursor:pointer}.article-title .operate-list-operate .icon-box[data-v-63c5943d]{border:1px solid #919191;border-radius:50%;width:30px;height:30px;line-height:30px;text-align:center;display:inline-block}.article-title .operate-list-operate .icon-box.act[data-v-63c5943d]{background:#398dee;color:#fff}.article-content[data-v-63c5943d]{padding:7px}.full-input[data-v-63c5943d]{font-size:17px;outline:none;color:#5f5f5f}.markdown .form-label-layout[data-v-63c5943d]{display:none}.markdown .article-content[data-v-63c5943d],.markdown .markdown-layout[data-v-63c5943d]{padding:0}.markdown .scroll-box[data-v-63c5943d]{overflow:hidden}.markdown .form-group[data-v-63c5943d],.markdown .form-layout[data-v-63c5943d]{height:100%}.article-content.noSave[data-v-63c5943d]{border:1px solid #f4606c}.schema-operate-btn[data-v-63c5943d]{height:30px;line-height:30px;width:80px;text-align:center;background:#202020;color:#fff;display:inline-block;border-radius:2px;font-size:14px;cursor:pointer}",""])},434:function(t,e,o){"use strict";var n=o(222);o.n(n).a},435:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,"[data-v-7a36155f]:root{--text-color:red}.book-slider-layout[data-v-7a36155f]{padding:15px;background:#2d2d2d}.book-layout[data-v-7a36155f]{margin-top:40px;width:38px;height:38px;cursor:pointer;position:relative;z-index:1}.book-layout .book-icon-layout[data-v-7a36155f]{line-height:38px;width:100%;height:100%;text-align:center;border-radius:50%;background:#fff;overflow:hidden;position:relative}.book-layout .iconfont[data-v-7a36155f]{font-size:26px}.book-layout .book-list-layout[data-v-7a36155f]{max-width:300px;padding:7px 20px;background:#2d2d2d;position:absolute;left:100%;top:0;transition:.3s;-webkit-transform:scale(0);transform:scale(0);-webkit-transform-origin:0 15px;transform-origin:0 15px}.book-layout .book-list-layout .book-list-item-layout[data-v-7a36155f]{color:#fff;text-align:center}.book-layout .book-list-layout .book-list-item-layout .icon[data-v-7a36155f]{width:25px;height:25px;line-height:22px;border:1px solid #fff;border-radius:50%}.book-layout .book-list-layout .book-list-item-layout .icon .iconfont[data-v-7a36155f]{font-size:16px}.book-layout .book-list-layout .book-list-item-layout .book-name[data-v-7a36155f]{font-size:12px;margin-left:10px}.book-layout .book-list-layout .book-list-item-layout[data-v-7a36155f]:not(:last-child){margin-bottom:10px}.book-layout .book-list-layout .book-list-item-layout.act .icon[data-v-7a36155f]{border:1px solid #398dee;background:#398dee}.show-book-list:hover .book-list-layout[data-v-7a36155f]{-webkit-transform:scale(1);transform:scale(1)}.book-layout.act[data-v-7a36155f]{-webkit-transform:scale(1.2);transform:scale(1.2)}.book-layout.act .book-icon-layout[data-v-7a36155f]{background:#398dee}.book-layout.act .book-icon-layout .iconfont[data-v-7a36155f]{color:#fff}.book-layout[data-v-7a36155f]:not(:last-child){margin-bottom:10px}.catalog-layout[data-v-7a36155f]{padding:15px 2px;overflow:auto;background:#2d2d2d;color:#919191;width:200px;max-width:200px;transition:.3s}.hidden-catalog[data-v-7a36155f]{padding:15px 0;max-width:0;overflow:hidden}",""])},450:function(t,e,o){"use strict";o.r(e);var n=o(85),r=(o(32),o(64),o(23),o(12),o(86),o(18),o(2)),c=(o(211),o(6)),l=o(24),d=o(4),h=o(3),f=o(83),m=o(231),v=(o(44),o(25)),x={props:{list:{type:Array,default:function(){return[]}}},data:function(){return{filterKeys:""}},computed:Object(c.a)({},Object(l.e)({showBrief:function(t){return t.config.showBrief},bookList:function(t){return t.books.list},schemaList:function(t){return t.schema.list},curNote:function(t){return t.notes.curNote},notesMap:function(t){return t.notes.notesMap},filterList:function(){var t=this;return this.filterKeys?this.list.filter(function(e){return e.title.indexOf(t.filterKeys)>-1}):this.list}})),watch:{list:function(t){!t.length||this.curNode&&"new"!==this.curNode||this.chooseNote(t[0])}},filters:{getBookName:function(t,e){return e[t]?e[t].name:""},getCatalogsName:function(t,e){return e[t]?e[t].name:""}},methods:Object(c.a)({},Object(l.b)("notes",[h.NOTE_DELETE]),Object(l.d)("notes",[d.NOTE_CUR_UPDATE]),{chooseNote:function(t){this.$emit("emitToChooseCurNote",t)},todoDelete:function(t){var e=this;this.$alert({title:'你确认要删除"'.concat(t.title,'"')}).then(function(){var o=Object(r.a)(regeneratorRuntime.mark(function o(n){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n&&e.doDeleteArticle(t);case 1:case"end":return o.stop()}},o)}));return function(t){return o.apply(this,arguments)}}())},doDeleteArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},this.$showLoading(),t.next=4,this[h.NOTE_DELETE]({_id:e._id});case 4:o=t.sent,this.$hideLoading(),o.err||this.$toast({title:"删除成功"}),this.curNote===e._id&&this[d.NOTE_CUR_UPDATE](""),this.$emit("emitUpdateNote");case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),shortcutAdd:function(){var t=this.notesMap[this.curNote].catalogId;t?this.$emit("emitToCreateNote",{_id:"new",catalogId:t}):this.$alert({title:"shortcutAdd",content:"缺少catalogId，无法创建笔记"})}})},k=(o(240),o(9)),y=Object(k.a)(x,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout box-shadow flex direction-column",class:{"hidden-article":!t.showBrief}},[o("div",{staticClass:"flex-1 flex direction-column article-min-width relative"},[o("div",{staticClass:"article-layout-input-box align-items-center"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.filterKeys,expression:"filterKeys"}],staticClass:"article-layout-input",attrs:{type:"text"},domProps:{value:t.filterKeys},on:{input:function(e){e.target.composing||(t.filterKeys=e.target.value)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-sousuo"})]),t._v(" "),o("div",{staticClass:"flex-1 article-item-box"},t._l(t.filterList,function(e,n){return o("div",{key:n,staticClass:"article-item",class:{act:e._id===t.curNote},on:{click:function(o){return t.chooseNote(e)}}},[o("div",{staticClass:"article-item-title"},[t._v(t._s(e.title))]),t._v(" "),o("div",{staticClass:"article-label"},[o("span",{staticClass:"article-label-item"},[t._v(t._s(t._f("getBookName")(e.bookId,t.bookList)))])]),t._v(" "),o("div",{staticClass:"article-item-mark"},[t._v(t._s(t._f("timestampToBriefTime")(e.createTime))+"~"+t._s(t._f("timestampToBriefTime")(e.updateTime)))]),t._v(" "),o("div",{staticClass:"operate-icon",on:{click:function(o){return o.stopPropagation(),t.todoDelete(e)}}},[o("i",{staticClass:"iconfont icon-shanchu1"})])])}),0),t._v(" "),o("div",{staticClass:"shortcut-add-layout",on:{click:t.shortcutAdd}})])])},[],!1,null,"1268941a",null).exports,w=(o(65),o(66),o(233)),C={props:{curNote:{type:Object},createToCatalogId:{type:String}},data:function(){return{articleName:"未命名",cacheName:"未命名",content:"",editId:"new",schemaId:"",catalogId:"",test:"123",fields:[],contentList:[],cacheContent:"",isEditContents:!1,showList:!1,showEditContent:!1}},components:{MarkdownEdit:w.a},computed:Object(c.a)({},Object(l.e)({catalogs:function(t){return t.catalogs.list},bookList:function(t){return t.books.list},articles:function(t){return t.articles.list}}),{dataHasChange:function(){return JSON.stringify(this.content)!==JSON.stringify(this.cacheContent)}}),watch:{curNote:function(t){this.setContent(t)},editId:function(t){this[d.ARTICLE_CUS_SAVE](t)}},methods:Object(c.a)({},Object(l.d)("articles",[d.ARTICLE_CUS_SAVE]),Object(l.d)("books",[d.BOOK_CUR_UPDATE]),Object(l.b)("articles",[h.ARTICLE_DES_GET,h.ARTICLE_POST,h.ARTICLE_PUT,h.ARTICLE_CONTENT_PUT,h.ARTICLE_CONTENT_POST,h.ARTICLE_CONTENT_DELETE]),Object(l.b)("notes",[h.NOTE_POST,h.NOTE_PUT,h.NOTE_DELETE]),{setContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._id?(this.cacheContent=this.content=t.content||"",this.cacheName=this.articleName=t.title||"未命名"):this.$alert({title:"setContent",content:"val值不正确"})},initContent:function(t,e){return t&&t.length&&t.forEach(function(t){e[t._id]||(e[t._id]=t.default?t.default:"")}),e},todoEditContent:function(t){this.showEditContent=!0;var content=t||{_id:"new"},e={editId:this.editId,_id:this.schemaId,catalogId:this.catalogId,fields:this.fields,title:this.articleName,list:this.showList,content:content};this.setMeta(e)},doDeleteContent:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$showLoading(),t.next=3,this[h.ARTICLE_CONTENT_DELETE]({articleId:this.editId,contentId:e._id});case 3:o=t.sent,this.$hideLoading(),o.err||(this.$toast({title:"删除成功"}),this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:this.editId}));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getContentList:function(){if("new"!==this.editId){var data=this.articles[this.editId].contents;return this.contentList=Object(n.a)(data),data}this.contentList=[]},changeSelect:function(t,e){"[object Array]"!==Object.prototype.toString.call(this.contents[t])&&(this.contents[t]=[]);var o=this.contents[t].indexOf(e.id);o>-1?this.contents[t].splice(o,1):(Object(n.a)(this.contents[t]).push(e.id),this.contents[t].push(e.id),this.contents=JSON.parse(JSON.stringify(this.contents)))},toggleList:function(){this.showList=!this.showList,this.articleName||(this.articleName=this.cacheName),this.todoEdit(!0)},todoEdit:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o.length>0&&void 0!==o[0]&&o[0]){t.next=4;break}if(this.articleName&&"new"!==this.editId&&this.cacheName!==this.articleName){t.next=4;break}return t.abrupt("return");case 4:return this.$showLoading(),t.next=7,this[h.ARTICLE_PUT]({_id:this.editId,content:this.contents,title:this.articleName,list:this.showList});case 7:if(t.sent.err){t.next=14;break}return this.$toast({title:"保存成功"}),e=this.editId,t.next=13,this.getData(e,!0);case 13:this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:e,getData:"getArticleByCatalogId"});case 14:this.$hideLoading();case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),todoSave:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.articleName){t.next=2;break}return t.abrupt("return");case 2:return this.$showLoading(),t.next=5,this[h.NOTE_POST]({content:this.content,title:this.articleName,catalogId:this.createToCatalogId});case 5:(e=t.sent).err||(this.$toast({title:"添加成功"}),o=e.data.id,this.$emit("emitUpdateNote",{id:o})),this.$hideLoading();case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=l.length>1&&void 0!==l[1]&&l[1],this.editId=e,this.$showLoading(),t.next=5,this[h.ARTICLE_DES_GET]({_id:e,force:o});case 5:(n=t.sent).err||(r=n.data,c=r.bookId,r.catalogId,void 0,this[d.BOOK_CUR_UPDATE](c)),this.$hideLoading();case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),toDoPutNote:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dataHasChange&&"new"!==this.curNote._id){t.next=2;break}return t.abrupt("return");case 2:return this.isEditContents=!1,this.$showLoading(),t.next=6,this[h.NOTE_PUT]({_id:this.curNote._id,content:this.content});case 6:e=t.sent,this.$hideLoading(),e.err||this.$toast({title:"修改成功"}),this.dataHasChange=this.content,this.$emit("emitUpdateNote");case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),init:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.$route.params.id)){t.next=5;break}return this.editId=e,t.next=5,this.getData(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),mounted:function(){this.init()}},_=(o(430),Object(k.a)(C,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout flex direction-column flex-1 markdown"},[o("div",{staticClass:"article-title flex "},[o("div",{staticClass:"flex-1 schema-title-layout relative"},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.articleName,expression:"articleName",modifiers:{trim:!0}}],staticClass:"full-input",domProps:{value:t.articleName},on:{blur:[function(e){return t.todoEdit(!1)},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.articleName=e.target.value.trim())}}})]),t._v(" "),o("div",{staticClass:"schema-operate"},[o("span",{directives:[{name:"show",rawName:"v-show",value:"new"===t.curNote._id,expression:"curNote._id==='new'"}],staticClass:"schema-operate-btn",class:{"disable-btn":!1},on:{click:t.todoSave}},[t._v("保存")])])]),t._v(" "),o("div",{staticClass:"flex-1 flex"},[o("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.toDoPutNote,expression:"toDoPutNote"}],staticClass:"article-content relative flex-1 flex",class:{noSave:t.dataHasChange},on:{click:function(e){t.isEditContents=!0},keydown:function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.toDoPutNote(e)):null}}},[o("div",{staticClass:"flex-1 relative"},[o("div",{staticClass:"scroll-box"},[o("div",{staticClass:"form-layout theme-1"},[o("markdown-edit",{model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])])])])},[],!1,null,"63c5943d",null).exports),N=o(232),E={components:{TreeItem:m.a,NoteBrief:y,noteDes:_,articleFixed:N.a},data:function(){return{editMeta:{editId:""},curArticleList:[],cusArticle:"",createToCatalogId:""}},computed:Object(c.a)({},Object(l.e)({schemaList:function(t){return t.schema.list},articleList:function(t){return t.articles.catalogMapArticles},noteList:function(t){return t.notes.list},curBook:function(t){return t.books.curBook},curNote:function(t){return t.notes.curNote},articles:function(t){return t.articles.list},showDir:function(t){return t.config.showDir},curCatalog:function(t){return t.catalogs.curCatalog}}),Object(l.c)("catalogs",["treeChainList"]),{curNoteList:function(){return console.log("",this.curCatalog,this.noteList),this.curCatalog&&this.noteList&&this.curBook&&this.noteList[this.curBook+"_"+this.curCatalog]||[]},curEditNote:function(){var t=this,e=this.curNoteList.find(function(e){return e._id===t.curNote});return e||{_id:"new"}}}),methods:Object(c.a)({},Object(l.d)("catalogs",[d.CATALOGS_CUR_SAVE]),Object(l.d)("notes",[d.NOTE_CUR_UPDATE]),Object(l.b)("books",[h.BOOK_LIST_GET]),Object(l.b)("schema",[h.SCHEMA_LIST_GET]),Object(l.b)("articles",[h.ARTICLE_RECENTLY_LIST_GET,h.ARTICLE_LIST_GET,h.ARTICLE_DES_GET]),Object(l.b)("notes",[h.NOTES_RECENTLY_GET,h.NOTES_GET]),Object(l.b)("catalogs",[h.CATALOGS_GET]),{getNoteData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Promise.all([this[h.BOOK_LIST_GET](),this[h.CATALOGS_GET]({parentId:"root",bookId:this.curBook})]).then(function(){e[h.NOTES_RECENTLY_GET]()}).catch(function(t){console.log("err",t),e.$alert({title:"getBookData",content:t.message})});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),chooseCurNote:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this[d.NOTE_CUR_UPDATE](e._id);case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),toCreateNote:function(t){this.createToCatalogId=t.catalogId,this.chooseCurNote({_id:"new"})},doCreateArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.catalogId,n=e.schemaId,t.next=3,this.getArticleByCatalogId(o);case 3:this.setEditMeta(o,n,"new");case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),doUpdateNote:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:{},o=e.id,console.log(1111,this.curCatalog),this.curCatalog!==v.a.recentlyArticlesKey){t.next=8;break}return t.next=6,this[h.NOTES_RECENTLY_GET]({force:!0});case 6:t.next=10;break;case 8:return t.next=10,this[h.NOTES_GET]({force:!0});case 10:o&&this.chooseCurNote({_id:o});case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),doShowArticleFromCatalog:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l,d,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.catalogId,n=e.articleId,r=e.contentId,c=void 0===r?"":r,t.next=3,this.getArticleByCatalogId(o);case 3:this.curArticleList&&this.curArticleList.length&&(l=this.curArticleList[0],d=l.catalogId,h=l.schemaId,this.chooseCurArticle({catalogId:d,schemaId:h,articleId:n||this.curArticleList[0]._id,contentId:c}));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),setEditMeta:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o,n,r){var l,d,h,f,m,v,x,k;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o||this.$alert({title:"缺少schemaId",showCancel:!1}),void 0,l=this.schemaList[o],d=l.fields,t.next=6,this.initContent(n,d,r);case 6:if(h=t.sent,f=h.tempObj,m=h.editTitle,v=h.list,x=Object(c.a)({},l,{catalogId:e,editId:n,list:v,content:JSON.parse(JSON.stringify(f)),title:m}),!(k=this.validEditMata(x))){t.next=15;break}return this.$alert({title:"editMeta的内容有错",content:k}),t.abrupt("return");case 15:this.editMeta=x,this.cusArticle=n;case 17:case"end":return t.stop()}},t,this)}));return function(e,o,n,r){return t.apply(this,arguments)}}(),initContent:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o,n){var r,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0,r={},c="未命名",l=!1,"new"!==e){t.next=8;break}o&&o.length&&o.forEach(function(t){r[t._id]=t.default?t.default:""}),t.next=14;break;case 8:if(this.articles[e]){t.next=11;break}return t.next=11,this.getData(e);case 11:c=this.articles[e].title,l=this.articles[e].list,this.articles[e].contents&&this.articles[e].contents.length&&(r=n?this.articles[e].contents.find(function(t){return t._id===n}):this.articles[e].contents[0]);case 14:return t.abrupt("return",{tempObj:r,editTitle:c,list:l});case 15:case"end":return t.stop()}},t,this)}));return function(e,o,n){return t.apply(this,arguments)}}(),validEditMata:function(data){var t=data.editId,e=data.fields,o=data._id,n=data.catalogId,title=data.title;return t?title?Object.keys(e).length?o?n?null:"catalogId不能为空":"_id(article)不能为空":"fields无效:".concat(JSON.stringify(e)):"title不能为空":"editId不能为空"},getData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.length>1&&void 0!==n[1]&&n[1],this.editId=e,this.$showLoading(),t.next=5,this[h.ARTICLE_DES_GET]({_id:e,force:o});case 5:t.sent,this.$hideLoading();case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getArticleByCatalogId:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e!==v.a.recentlyArticlesKey){t.next=3;break}return this.setArticleBrief(),t.abrupt("return");case 3:if(this.curBook){t.next=6;break}return this.$alert({content:"缺少bookId",showCancel:!1}),t.abrupt("return");case 6:return this.$showLoading(),t.next=9,this[h.ARTICLE_LIST_GET]({bookId:this.curBook,catalogId:e});case 9:return o=t.sent,this.setArticleBrief(),this.$hideLoading(),t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),setArticleBrief:function(){if(!Object.keys(this.articleList).length)return this.curArticleList=[],void(this.editMeta.editId="");var t=this.treeChainList[this.treeChainList.length-1],e=t===v.a.recentlyArticlesKey?v.a.recentlyArticlesKey:"".concat(this.curBook,"_").concat(t),o=this.articleList[e];if(!o)return this.curArticleList=[],void(this.editMeta.editId="");this.curArticleList=Object(n.a)(o)},init:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.getNoteData(),f.a.$on("emitToCreateArticle",function(t){e.toCreateNote(t)}),f.a.$on("emitFromCatalog",function(t){t.isNew?e.toCreateNote({catalogId:t.catalogId}):e.doUpdateNote(t)}),f.a.$on("updateCurBooks",function(){e[d.CATALOGS_CUR_SAVE](v.a.recentlyArticlesKey),e.getNoteData()});case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),mounted:function(){this.init()}},T=(o(434),Object(k.a)(E,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flex flex-1"},[o("div",{staticClass:"catalog-layout box-shadow",class:{"hidden-catalog":!t.showDir}},[o("TreeItem")],1),t._v(" "),o("NoteBrief",{attrs:{list:t.curNoteList,cusArticle:t.cusArticle},on:{emitToChooseCurNote:t.chooseCurNote,emitToCreateNote:t.toCreateNote,emitUpdateNote:t.doUpdateNote,emitInitArticle:t.doShowArticleFromCatalog}}),t._v(" "),o("note-des",{attrs:{curNote:t.curEditNote,createToCatalogId:t.createToCatalogId},on:{emitUpdateNote:t.doUpdateNote}}),t._v(" "),o("articleFixed")],1)},[],!1,null,"7a36155f",null));e.default=T.exports}}]);