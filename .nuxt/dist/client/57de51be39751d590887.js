(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{259:function(t,e,o){"use strict";function r(t,e){return e?"root"===t?"".concat(e,"_root"):t:t.indexOf("root")>-1?"root":t}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(t,"-黑洞笔记-BlackHook")}o.d(e,"a",function(){return r}),o.d(e,"b",function(){return n})},260:function(t,e,o){var content=o(298);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(12).default)("9fd8ec10",content,!0,{sourceMap:!1})},261:function(t,e,o){var content=o(300);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(12).default)("5fdb5f2e",content,!0,{sourceMap:!1})},267:function(t,e,o){"use strict";o(17),o(15),o(10),o(9),o(13),o(19);var r=o(2),n=(o(49),o(0)),c=o(8),d=o(295),l=o.n(d),f=o(1),h=o(3),m=(o(130),o(27),o(259));function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,o)}return e}function x(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(source,!0).forEach(function(e){Object(n.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}var y,w={props:{list:{type:Array,default:function(){return[]}}},data:function(){return{filterKeys:"",filterList:[],drag:!1}},components:{draggable:l.a},computed:x({},Object(c.e)({curCatalog:function(t){return t.catalogs.curCatalog},showBrief:function(t){return t.config.showBrief},bookList:function(t){return t.books.list},schemaList:function(t){return t.schema.list},curNote:function(t){return t.notes.curNote},notesMap:function(t){return t.notes.notesMap}}),{},Object(c.c)("user",["isVisitor"]),{dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}}),watch:{list:function(t){t.length&&(!this.curNode||this.curNode)},filterKeys:function(t){this.getList()}},filters:{getBookName:function(t,e){return e[t]?e[t].name:""},getCatalogsName:function(t,e){return e[t]?e[t].name:""}},methods:x({},Object(c.b)("notes",[h.NOTE_DELETE]),{},Object(c.d)("notes",[f.NOTE_CUR_UPDATE]),{chooseNote:function(t){this.$router.push("/".concat(t.bookId,"/").concat(Object(m.a)(this.curCatalog),"/").concat(t._id))},todoDelete:function(t){var e=this;this.$alert({title:'你确认要删除"'.concat(t.title,'"')}).then(function(){var o=Object(r.a)(regeneratorRuntime.mark(function o(r){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:r&&e.doDeleteNote(t);case 1:case"end":return o.stop()}},o)}));return function(t){return o.apply(this,arguments)}}())},doDeleteNote:(y=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o,r=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},this.$showLoading(),t.next=4,this[h.NOTE_DELETE]({_id:e._id});case 4:o=t.sent,this.$hideLoading(),o.err||this.$toast({title:"删除成功"}),this.curNote===e._id&&this[f.NOTE_CUR_UPDATE](""),this.$emit("emitUpdateNote",{force:!0});case 9:case"end":return t.stop()}},t,this)})),function(){return y.apply(this,arguments)}),shortcutAdd:function(){var t=this.notesMap[this.curNote].catalogId;t?this.$emit("emitToCreateNote",{_id:"new",catalogId:t}):this.$alert({title:"shortcutAdd",content:"缺少catalogId，无法创建笔记"})},dragEnd:function(){this.drag=!1,console.log(this.filterList)},getList:function(){var t=this;this.filterKeys||(this.filterList=this.list),this.filterList=this.list.filter(function(e){return e.title.indexOf(t.filterKeys)>-1})}}),mounted:function(){this.getList()}},O=(o(297),o(7)),component=Object(O.a)(w,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout box-shadow flex direction-column",class:{"hidden-article":!t.showBrief}},[o("div",{staticClass:"flex-1 flex direction-column article-min-width relative"},[o("div",{staticClass:"article-layout-input-box align-items-center"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.filterKeys,expression:"filterKeys"}],staticClass:"article-layout-input",attrs:{type:"text"},domProps:{value:t.filterKeys},on:{input:function(e){e.target.composing||(t.filterKeys=e.target.value)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-sousuo"})]),t._v(" "),o("div",{staticClass:"flex-1 relative"},[o("div",{staticClass:"absolute-full article-item-box",attrs:{id:"article-item-box"}},[o("draggable",t._b({attrs:{group:"people",handle:".operate-icon-sort"},on:{start:function(e){t.drag=!0},end:t.dragEnd},model:{value:t.filterList,callback:function(e){t.filterList=e},expression:"filterList"}},"draggable",t.dragOptions,!1),[o("transition-group",{attrs:{type:"transition",name:t.drag?null:"flip-list"}},t._l(t.filterList,function(e,r){return o("div",{key:e._id,staticClass:"article-item",class:{act:e._id===t.curNote},attrs:{id:e._id},on:{click:function(o){return t.chooseNote(e)}}},[o("div",{staticClass:"article-item-title"},[t._v(t._s(e.title))]),t._v(" "),o("div",{staticClass:"article-label"},[o("span",{staticClass:"article-label-item"},[t._v(t._s(t._f("getBookName")(e.bookId,t.bookList)))])]),t._v(" "),o("div",{staticClass:"article-item-mark"},[t._v(t._s(t._f("timestampToBriefTime")(e.createTime))+"~"+t._s(t._f("timestampToBriefTime")(e.updateTime)))]),t._v(" "),o("div",{staticClass:"operate-icon operate-icon-delete",on:{click:function(o){return o.stopPropagation(),t.todoDelete(e)}}},[o("i",{staticClass:"iconfont icon-shanchu1"})]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.filterKeys,expression:"!filterKeys"}],staticClass:"operate-icon operate-icon-sort",on:{click:function(o){return o.stopPropagation(),t.todoDelete(e)}}},[o("i",{staticClass:"iconfont icon-paixu"})])])}),0)],1)],1)]),t._v(" "),t.notesMap[t.curNote]&&!t.isVisitor?o("div",{staticClass:"shortcut-add-layout",on:{click:t.shortcutAdd}},[o("i",{staticClass:"iconfont icon-tianjiawenjian"})]):t._e()])])},[],!1,null,"720dfc83",null);e.a=component.exports},268:function(t,e,o){"use strict";o(17),o(15),o(10),o(9),o(13),o(19);var r=o(2),n=o(0),c=o(8),d=o(1),l=o(3),f=o(271);function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,o)}return e}function m(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(source,!0).forEach(function(e){Object(n.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}var v,x,y,w,O,_,k={props:{curNote:{type:Object},createToCatalogId:{type:String},curNoteContent:{type:Object}},data:function(){var t=this.curNoteContent||{},e=t.title,title=void 0===e?"未命名":e,o=t.content;return{articleName:title,cacheName:title,content:void 0===o?"":o,editId:"new",schemaId:"",catalogId:"",test:"123",fields:[],contentList:[],cacheContent:"",isEditContents:!1,showList:!1,showEditContent:!1}},components:{MarkdownEdit:f.a},computed:m({},Object(c.e)({catalogs:function(t){return t.catalogs.list},bookList:function(t){return t.books.list},articles:function(t){return t.articles.list}}),{},Object(c.c)("user",["isVisitor"]),{dataHasChange:function(){return JSON.stringify(this.content)!==JSON.stringify(this.cacheContent)}}),watch:{curNote:{handler:function(t){this.setContent(t)},immediate:!0},editId:function(t){this[d.ARTICLE_CUS_SAVE](t)}},methods:m({},Object(c.d)("articles",[d.ARTICLE_CUS_SAVE]),{},Object(c.d)("books",[d.BOOK_CUR_UPDATE]),{},Object(c.b)("articles",[l.ARTICLE_DES_GET,l.ARTICLE_POST,l.ARTICLE_PUT,l.ARTICLE_CONTENT_PUT,l.ARTICLE_CONTENT_POST,l.ARTICLE_CONTENT_DELETE]),{},Object(c.b)("notes",[l.NOTE_POST,l.NOTE_PUT,l.NOTE_DELETE]),{setContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._id?(this.cacheContent=this.content=t.content||"",this.cacheName=this.articleName=t.title||"未命名"):this.$alert({title:"setContent",content:"val值不正确"})},todoEdit:(_=Object(r.a)(regeneratorRuntime.mark(function t(){var e=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.length>0&&void 0!==e[0]&&e[0]){t.next=4;break}if("new"!==this.curNote._id&&this.articleName&&this.cacheName!==this.articleName){t.next=4;break}return t.abrupt("return");case 4:this.doPutNote();case 5:case"end":return t.stop()}},t,this)})),function(){return _.apply(this,arguments)}),todoSave:(O=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.articleName){t.next=2;break}return t.abrupt("return");case 2:return this.$showLoading(),t.next=5,this[l.NOTE_POST]({content:this.content,title:this.articleName,catalogId:this.createToCatalogId});case 5:(e=t.sent).err||(this.$toast({title:"添加成功"}),o=e.data.id,this.$emit("emitUpdateNote",{id:o,force:!0})),this.$hideLoading();case 8:case"end":return t.stop()}},t,this)})),function(){return O.apply(this,arguments)}),getData:(w=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,r,n,c,f=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=f.length>1&&void 0!==f[1]&&f[1],this.editId=e,this.$showLoading(),t.next=5,this[l.ARTICLE_DES_GET]({_id:e,force:o});case 5:(r=t.sent).err||(n=r.data,c=n.bookId,n.catalogId,this[d.BOOK_CUR_UPDATE](c)),this.$hideLoading();case 8:case"end":return t.stop()}},t,this)})),function(t){return w.apply(this,arguments)}),toDoPutNote:(y=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isVisitor){t.next=2;break}return t.abrupt("return");case 2:if(this.dataHasChange&&"new"!==this.curNote._id){t.next=4;break}return t.abrupt("return");case 4:this.doPutNote();case 5:case"end":return t.stop()}},t,this)})),function(){return y.apply(this,arguments)}),doPutNote:(x=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.isEditContents=!1,this.$showLoading(),t.next=4,this[l.NOTE_PUT]({_id:this.curNote._id,title:this.articleName,content:this.content});case 4:e=t.sent,this.$hideLoading(),e.err||this.$toast({title:"修改成功"}),this.cacheName=this.articleName,this.cacheContent=this.content,this.$emit("emitUpdateNote",{force:!0,id:this.curNote._id});case 10:case"end":return t.stop()}},t,this)})),function(){return x.apply(this,arguments)}),init:(v=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.$route.params.id)){t.next=5;break}return this.editId=e,t.next=5,this.getData(e);case 5:case"end":return t.stop()}},t,this)})),function(){return v.apply(this,arguments)})}),mounted:function(){this.init()}},N=(o(299),o(7)),component=Object(N.a)(k,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout flex direction-column flex-1 markdown"},[o("div",{staticClass:"article-title flex "},[o("div",{staticClass:"flex-1 schema-title-layout relative"},[t.isVisitor?o("div",{staticClass:"full-input"},[t._v(t._s(t.articleName))]):o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.articleName,expression:"articleName",modifiers:{trim:!0}}],staticClass:"full-input",domProps:{value:t.articleName},on:{blur:[function(e){return t.todoEdit(!1)},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.articleName=e.target.value.trim())}}})]),t._v(" "),t.isVisitor?t._e():o("div",{staticClass:"schema-operate"},[o("span",{directives:[{name:"show",rawName:"v-show",value:"new"===t.curNote._id,expression:"curNote._id==='new'"}],staticClass:"schema-operate-btn",class:{"disable-btn":!1},on:{click:t.todoSave}},[t._v("保存")])])]),t._v(" "),o("div",{staticClass:"flex-1 flex"},[o("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.toDoPutNote,expression:"toDoPutNote"}],staticClass:"article-content relative flex-1 flex",class:{noSave:t.dataHasChange},on:{click:function(e){t.isEditContents=!0},keydown:function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.toDoPutNote(e)):null}}},[o("div",{staticClass:"flex-1 relative"},[o("div",{staticClass:"form-layout theme-1"},[o("markdown-edit",{attrs:{onlyView:t.isVisitor,showEdit:"new"===t.curNote._id},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])])])])},[],!1,null,"3c55dda7",null);e.a=component.exports},297:function(t,e,o){"use strict";var r=o(260);o.n(r).a},298:function(t,e,o){(t.exports=o(11)(!1)).push([t.i,'[data-v-720dfc83]:root{--text-color:red}.article-item[data-v-720dfc83]{padding:10px 20px;width:100%;cursor:pointer;position:relative;border-bottom:1px solid #000}.article-item .article-item-title[data-v-720dfc83]{font-size:17px;color:#ddd}.article-item .article-item-mark[data-v-720dfc83]{margin-top:7px;font-size:12px}.article-item .operate-icon[data-v-720dfc83]{width:30px;height:30px;border-radius:50%;position:absolute;z-index:1;background:#5f5f5f;opacity:0;transform:scale(0);transition:.3s;text-align:center;line-height:30px;color:#19181d}.article-item .operate-icon .iconfont[data-v-720dfc83]{font-size:18px}.article-item .operate-icon-delete[data-v-720dfc83]{right:7px;top:7px}.article-item .operate-icon-sort[data-v-720dfc83]{right:7px;bottom:7px;cursor:move}.article-item .operate-icon-delete[data-v-720dfc83]:hover{background:#f4606c;color:#fff}.article-item .operate-icon-sort[data-v-720dfc83]:hover{background:#398dee;color:#fff}.article-item:hover .operate-icon[data-v-720dfc83]{opacity:1;transform:scale(1)}.article-item.act[data-v-720dfc83]{background:#19181d}.article-item.act[data-v-720dfc83]:after{content:"";position:absolute;width:4px;height:100%;left:0;top:0;background:#afb0b1}.article-layout[data-v-720dfc83]{padding:15px 0;background:#2d2d2d;color:#919191;max-width:500px;transition:.3s}.article-layout .article-min-width[data-v-720dfc83]{min-width:200px}.article-layout.hidden-article[data-v-720dfc83]{max-width:0;overflow:hidden}.article-layout-input-box[data-v-720dfc83]{background:#5f5f5f;color:#ddd;width:90%;height:40px;padding:0 10px;position:relative;margin:0 auto 10px}.article-layout-input-box .iconfont[data-v-720dfc83]{display:block;position:absolute;right:10px;top:50%;transform:translateY(-50%)}.article-layout-input[data-v-720dfc83]{height:100%;border:none;background:transparent;display:inline-block;color:#ddd;outline:#fff;padding-right:46px}.article-label[data-v-720dfc83]{margin:7px 0}.article-label-item[data-v-720dfc83]{display:inline-block;padding:2px 5px;background:#5f5f5f;color:#202020;border-radius:2px;margin-bottom:3px;font-size:12px}.article-item-box[data-v-720dfc83]{overflow-y:auto;overflow-x:hidden}.shortcut-add-layout[data-v-720dfc83]{position:absolute;bottom:10px;right:10px;background:#398dee;z-index:5;width:42px;height:42px;border-radius:42px;cursor:pointer;text-align:center;line-height:44px}.shortcut-add-layout .iconfont[data-v-720dfc83]{font-size:30px;color:#2d2d2d}.flip-list-move[data-v-720dfc83]{transition:transform .5s}.no-move[data-v-720dfc83]{transition:transform 0s}.ghost[data-v-720dfc83]{opacity:.5;background:#c8ebfb}',""])},299:function(t,e,o){"use strict";var r=o(261);o.n(r).a},300:function(t,e,o){(t.exports=o(11)(!1)).push([t.i,"[data-v-3c55dda7]:root{--text-color:red}.article-layout[data-v-3c55dda7]{background:#eee;position:relative}.article-layout .form-label-layout[data-v-3c55dda7]{width:100%;text-align:left;font-size:12px;color:#adabab;padding-left:0}.article-layout .form-content-layout[data-v-3c55dda7]{background:#fff;padding:7px 20px}.article-layout .add-options-item[data-v-3c55dda7]{margin:5px}.article-layout .form-input[data-v-3c55dda7],.article-layout .from-select[data-v-3c55dda7]{border:none;outline:none;padding:0}.article-layout .form-group[data-v-3c55dda7]:not(:first-child){margin:0}.article-layout .form-content-layout-select[data-v-3c55dda7]{padding-top:18px;padding-bottom:18px}.article-layout .markdown-layout[data-v-3c55dda7]{min-height:500px;padding:10px}.article-layout-theme1 .article-content[data-v-3c55dda7]{padding:40px}.article-layout-theme1 .form-label-layout[data-v-3c55dda7]{display:none}.article-layout-theme1 .form-input[data-v-3c55dda7],.article-layout-theme1 .from-select[data-v-3c55dda7]{border:none;outline:none;font-size:20px}.article-title[data-v-3c55dda7]{border-bottom:1px solid #e1e4e8;background:#fff;height:45px;line-height:45px;padding:0 15px}.article-title .operate-list-operate .iconfont[data-v-3c55dda7]{font-size:20px;cursor:pointer}.article-title .operate-list-operate .icon-box[data-v-3c55dda7]{border:1px solid #919191;border-radius:50%;width:30px;height:30px;line-height:30px;text-align:center;display:inline-block}.article-title .operate-list-operate .icon-box.act[data-v-3c55dda7]{background:#398dee;color:#fff}.article-content[data-v-3c55dda7]{padding:7px}.full-input[data-v-3c55dda7]{font-size:17px;outline:none;color:#5f5f5f}.markdown .form-label-layout[data-v-3c55dda7]{display:none}.markdown .article-content[data-v-3c55dda7],.markdown .markdown-layout[data-v-3c55dda7]{padding:0}.markdown .scroll-box[data-v-3c55dda7]{overflow:hidden}.markdown .form-group[data-v-3c55dda7],.markdown .form-layout[data-v-3c55dda7]{height:100%}.article-content.noSave[data-v-3c55dda7]{border:1px solid #f4606c}.schema-operate-btn[data-v-3c55dda7]{height:30px;line-height:30px;width:80px;text-align:center;background:#202020;color:#fff;display:inline-block;border-radius:2px;font-size:14px;cursor:pointer}",""])}}]);