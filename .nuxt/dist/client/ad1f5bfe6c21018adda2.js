(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{213:function(t,e,o){var content=o(230);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("5459e0b6",content,!0,{sourceMap:!1})},214:function(t,e,o){var content=o(232);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("e3f7925a",content,!0,{sourceMap:!1})},215:function(t,e,o){var content=o(234);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("05cf2934",content,!0,{sourceMap:!1})},216:function(t,e,o){var content=o(424);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("6e12c256",content,!0,{sourceMap:!1})},217:function(t,e,o){var content=o(426);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("10bde510",content,!0,{sourceMap:!1})},218:function(t,e,o){var content=o(428);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("108e5988",content,!0,{sourceMap:!1})},219:function(t,e,o){var content=o(430);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(17).default)("5a791fa9",content,!0,{sourceMap:!1})},229:function(t,e,o){"use strict";var n=o(213);o.n(n).a},230:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,'[data-v-7c521a1c]:root{--text-color:red}.catalogs-layout .catalogs-layout[data-v-7c521a1c]{padding-left:20px}.iconfont[data-v-7c521a1c]{font-size:25px;position:relative}.catalogs-item-layout[data-v-7c521a1c]{cursor:pointer;padding:7px 25px;position:relative;transition:.3s}.catalogs-item-layout .icon-open[data-v-7c521a1c]{display:none}.catalogs-item-layout .icon-close[data-v-7c521a1c]{display:block}.catalogs-item-layout[data-v-7c521a1c]:after{content:"";background:transparent;position:absolute;top:0;width:100%;height:100%;left:-100%;transition:.3s}.operate-triangle-btn[data-v-7c521a1c]{display:none;position:absolute;width:16px;height:16px;right:12px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.operate-triangle-btn .iconfont[data-v-7c521a1c]{font-size:15px}.catalogs-item-layout .has-child[data-v-7c521a1c]{position:absolute;border-left:6px solid #919191;border-top:5px solid transparent;border-bottom:5px solid transparent;width:0;height:0;left:12px;top:50%;-webkit-transform:translateY(-6px);transform:translateY(-6px);transition:.2s}.catalogs-item-layout .has-child[data-v-7c521a1c]:after{content:"";width:20px;height:20px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.catalogs-item-layout .has-child.in-chain[data-v-7c521a1c]{-webkit-transform:translateY(-6px) rotate(90deg);transform:translateY(-6px) rotate(90deg)}.catalogs-item-hover[data-v-7c521a1c]:hover{background:#404040;color:#ddd}.catalogs-item-hover:hover .operate-triangle-btn[data-v-7c521a1c]{display:block;color:#ddd}.catalogs-item-hover[data-v-7c521a1c]:hover:after{background:#404040}.catalogs-item-layout.act[data-v-7c521a1c]{background:#5f5f5f;color:#ddd}.catalogs-item-layout.act .icon-open[data-v-7c521a1c]{display:block}.catalogs-item-layout.act .icon-close[data-v-7c521a1c]{display:none}.catalogs-item-layout.act[data-v-7c521a1c]:after,.catalogs-item-layout.act[data-v-7c521a1c]:hover,.catalogs-item-layout.act[data-v-7c521a1c]:hover:after{background:#5f5f5f}.catalogs-name[data-v-7c521a1c],.edit-catalogs-input[data-v-7c521a1c]{position:relative;max-width:150px;padding:0 5px}.edit-catalogs-input[data-v-7c521a1c]{z-index:1;background:transparent;vertical-align:bottom;border:none;color:inherit;font-size:inherit;height:25px}.catalog-operate-layout[data-v-7c521a1c]{position:fixed;background:rgba(0,0,0,.8);left:50%;top:50%;color:#fff;z-index:999;border-radius:5px}.catalog-operate-layout .catalog-operate-item[data-v-7c521a1c]{width:150px;padding:10px 20px;position:relative}.catalog-operate-layout .catalog-operate-item[data-v-7c521a1c]:not(:last-child){border-bottom:1px solid hsla(0,0%,100%,.2)}.catalog-operate-layout .catalog-operate-item.hadChild[data-v-7c521a1c]:after{content:"";position:absolute;border-left:4px solid #fff;border-top:4px solid transparent;border-bottom:4px solid transparent;right:10px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.catalog-operate-layout .catalog-operate-item:hover .operate-item-child[data-v-7c521a1c]{display:block}.catalog-operate-layout .operate-item-child[data-v-7c521a1c]{position:absolute;left:100%;top:0;width:100%;border-radius:0 5px 5px 0;background:rgba(0,0,0,.8);border-left:1px solid hsla(0,0%,100%,.2);display:none}.catalog-operate-layout .catalog-operate-item.builtIn[data-v-7c521a1c]{border-bottom:1px solid hsla(0,0%,100%,.6)}#hello_recent[data-v-7c521a1c]{font-size:24px}',""])},231:function(t,e,o){"use strict";var n=o(214);o.n(n).a},232:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,'[data-v-29585472]:root{--text-color:red}.article-item[data-v-29585472]{padding:10px 20px;width:100%;cursor:pointer;position:relative;border-bottom:1px solid #000}.article-item .article-item-title[data-v-29585472]{font-size:17px;color:#ddd}.article-item .article-item-mark[data-v-29585472]{margin-top:7px;font-size:12px}.article-item .operate-icon[data-v-29585472]{width:30px;height:30px;border-radius:50%;right:7px;top:7px;position:absolute;z-index:1;background:#5f5f5f;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:.3s;text-align:center;line-height:30px;color:#19181d}.article-item .operate-icon .iconfont[data-v-29585472]{font-size:18px}.article-item .operate-icon[data-v-29585472]:hover{background:#f4606c;color:#fff}.article-item:hover .operate-icon[data-v-29585472]{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.article-item.act[data-v-29585472]{background:#19181d}.article-item.act[data-v-29585472]:after{content:"";position:absolute;width:4px;height:100%;left:0;top:0;background:#afb0b1}.article-layout[data-v-29585472]{padding:15px 0;background:#202020;color:#919191;max-width:500px;transition:.3s}.article-layout .article-min-width[data-v-29585472]{min-width:200px}.article-layout.hidden-article[data-v-29585472]{max-width:0;overflow:hidden}.article-layout-input-box[data-v-29585472]{background:#5f5f5f;color:#ddd;width:90%;height:40px;padding:0 10px;position:relative;margin:0 auto 10px}.article-layout-input-box .iconfont[data-v-29585472]{display:block;position:absolute;right:10px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.article-layout-input[data-v-29585472]{height:100%;border:none;background:transparent;display:inline-block;color:#ddd;outline:#fff;padding-right:46px}.article-label[data-v-29585472]{margin:7px 0}.article-label-item[data-v-29585472]{display:inline-block;padding:2px 5px;background:#5f5f5f;color:#202020;border-radius:2px;margin-bottom:3px;font-size:12px}.article-item-box[data-v-29585472]{overflow-y:auto;overflow-x:hidden}',""])},233:function(t,e,o){"use strict";var n=o(215);o.n(n).a},234:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,'[data-v-13d188fb]:root{--text-color:red}.content-list[data-v-13d188fb]{background:#fff;font-size:13px;position:relative}.content-list .content-list-item[data-v-13d188fb]{padding:10px;color:#2d2d2d;border-bottom:1px solid #adabab;position:relative;cursor:pointer}.content-list .content-list-item.act[data-v-13d188fb]{background:#fbfbfb}.content-list .content-list-item[data-v-13d188fb]:after{content:"";width:3px;height:100%;background:transparent;left:0;top:0;position:absolute;border-radius:0 2px 2px 0;transition:.3s}.content-list .content-list-item.act[data-v-13d188fb]:after{background:#398dee}.content-list .scroll-auto[data-v-13d188fb]{overflow:auto}.add-content-box[data-v-13d188fb]{height:60px;line-height:60px;text-align:center;position:absolute;bottom:0;left:0;width:100%;z-index:2;background:#fbfbfb;font-size:16px;color:#919191;cursor:pointer;transition:.3s;border-left:3px solid transparent}.add-content-box[data-v-13d188fb]:hover{background:#eee}.add-content-box.act[data-v-13d188fb]{border-left:3px solid #398dee}.form-label-layout[data-v-13d188fb]{width:auto}.form-group[data-v-13d188fb]:not(:first-child){margin-top:10px}.operate-icon[data-v-13d188fb]{width:30px;height:30px;border-radius:50%;right:7px;top:7px;position:absolute;z-index:1;background:#5f5f5f;opacity:0;-webkit-transform:scale(0);transform:scale(0);transition:.3s;text-align:center;line-height:30px;color:#19181d}.operate-icon .iconfont[data-v-13d188fb]{font-size:18px;color:#fff}.operate-icon[data-v-13d188fb]:hover{background:#f4606c;color:#fff}.content-list-item:hover .operate-icon[data-v-13d188fb]{opacity:1;-webkit-transform:scale(1);transform:scale(1)}.content-list-0[data-v-13d188fb]{font-size:16px}.is-done-layout[data-v-13d188fb]{position:absolute;border-color:transparent red red transparent;border-style:solid;border-width:20px;bottom:0;right:0;width:0;height:0;color:#fff;font-size:15px}.is-done-y[data-v-13d188fb]{border-right:20px solid #398dee;border-bottom:20px solid #398dee}.form-group[data-v-13d188fb]{overflow:hidden}',""])},423:function(t,e,o){"use strict";var n=o(216);o.n(n).a},424:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,'[data-v-1b621aae]:root{--text-color:red}#codeMirror[data-v-1b621aae],.showCompileMarkdownBox[data-v-1b621aae]{width:100%;height:100%}.code-mirror .demo-split-pane[data-v-1b621aae]{padding:10px;overflow:auto}.code-mirror .showCompileMarkdownBox[data-v-1b621aae]{padding:0 7px;overflow:auto;word-break:break-all}.code-mirror .ivu-split-horizontal[data-v-1b621aae]{height:100%}.code-mirror .code-mirror-tags[data-v-1b621aae]{background:#202020;position:relative}.code-mirror .code-mirror-tags .tags-item[data-v-1b621aae]{border-bottom:1px solid #fff;position:relative;display:inline-block;padding:12px 15px;cursor:pointer}.code-mirror .code-mirror-tags .tags-item.act[data-v-1b621aae]{color:#515a6e;background:#fff;z-index:2}.code-mirror .code-mirror-tags .tags-item[data-v-1b621aae]:hover{color:#000}.code-mirror .code-mirror-tags .tags-item-2[data-v-1b621aae]{display:inline-block;float:right;cursor:pointer}.code-mirror .code-mirror-tags .tags-item-2.act[data-v-1b621aae]{background:#313131;color:#fff}.code-mirror .code-mirror-tags[data-v-1b621aae]:after{content:"";height:1px;background:#e1e4e8;position:absolute;width:100%;left:0;z-index:1;bottom:0}.markdown-layout .markdown-edit-box[data-v-1b621aae]{width:100%;height:100%;overflow:auto;padding:20px;background:#202020;color:#919191;border:none;outline:none;font-size:14px}.markdown-layout .md-body-layout[data-v-1b621aae]{overflow:auto;padding:20px;background:#fff;box-shadow:inset 0 0 4px 1px #e7eaef}.markdown-layout .markdown-operate-layout[data-v-1b621aae]{position:absolute;z-index:2;right:20px;top:10px;color:#fff}.markdown-layout .markdown-operate-layout .icon-layout[data-v-1b621aae]{display:inline-block;background:rgba(0,0,0,.7);padding:3px 5px;cursor:pointer;border-radius:3px;text-align:center}.markdown-layout .markdown-operate-layout .icon-layout.act[data-v-1b621aae]{background:rgba(57,141,238,.7)}',""])},425:function(t,e,o){"use strict";var n=o(217);o.n(n).a},426:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,"[data-v-39d30912]:root{--text-color:red}.article-layout[data-v-39d30912]{background:#eee;position:relative}.article-layout .form-label-layout[data-v-39d30912]{width:100%;text-align:left;font-size:12px;color:#adabab;padding-left:0}.article-layout .form-content-layout[data-v-39d30912]{background:#fff;padding:7px 20px}.article-layout .add-options-item[data-v-39d30912]{margin:5px}.article-layout .form-input[data-v-39d30912],.article-layout .from-select[data-v-39d30912]{border:none;outline:none;padding:0}.article-layout .form-group[data-v-39d30912]:not(:first-child){margin:0}.article-layout .form-content-layout-select[data-v-39d30912]{padding-top:18px;padding-bottom:18px}.article-layout .markdown-layout[data-v-39d30912]{min-height:500px;position:relative;padding:10px}.article-layout-theme1 .article-content[data-v-39d30912]{padding:40px}.article-layout-theme1 .form-label-layout[data-v-39d30912]{display:none}.article-layout-theme1 .form-input[data-v-39d30912],.article-layout-theme1 .from-select[data-v-39d30912]{border:none;outline:none;font-size:20px}.article-title[data-v-39d30912]{border-bottom:1px solid #e1e4e8;background:#fff;height:45px;line-height:45px;padding:0 15px}.article-title .operate-list-operate .iconfont[data-v-39d30912]{font-size:20px;cursor:pointer}.article-title .operate-list-operate .icon-box[data-v-39d30912]{border:1px solid #919191;border-radius:50%;width:30px;height:30px;line-height:30px;text-align:center;display:inline-block}.article-title .operate-list-operate .icon-box.act[data-v-39d30912]{background:#398dee;color:#fff}.article-content[data-v-39d30912]{padding:7px}.full-input[data-v-39d30912]{font-size:17px;outline:none;color:#5f5f5f}.markdown .form-label-layout[data-v-39d30912]{display:none}.markdown .article-content[data-v-39d30912],.markdown .markdown-layout[data-v-39d30912]{padding:0}.markdown .scroll-box[data-v-39d30912]{overflow:hidden}.markdown .form-group[data-v-39d30912],.markdown .form-layout[data-v-39d30912]{height:100%}.article-content.noSave[data-v-39d30912]{border:1px solid #f4606c}.schema-operate-btn[data-v-39d30912]{height:30px;line-height:30px;width:80px;text-align:center;background:#202020;color:#fff;display:inline-block;border-radius:2px;font-size:14px;cursor:pointer}",""])},427:function(t,e,o){"use strict";var n=o(218);o.n(n).a},428:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,"[data-v-5b592daa]:root{--text-color:red}.controller-layout-fixed[data-v-5b592daa]{position:fixed;bottom:50px;left:0;z-index:10}.controller-layout-fixed .controller-layout-item[data-v-5b592daa]{width:30px;height:30px;line-height:30px;cursor:pointer;background:#919191;border-radius:0 20px 20px 0;margin-bottom:10px;text-align:center}.controller-layout-fixed .iconfont[data-v-5b592daa]{font-size:18px}.controller-layout-fixed .controller-layout-item.act[data-v-5b592daa]{background:#fff}",""])},429:function(t,e,o){"use strict";var n=o(219);o.n(n).a},430:function(t,e,o){(t.exports=o(16)(!1)).push([t.i,"[data-v-a9d8ac56]:root{--text-color:red}.book-slider-layout[data-v-a9d8ac56]{padding:15px;background:#2d2d2d}.book-layout[data-v-a9d8ac56]{margin-top:40px;width:38px;height:38px;cursor:pointer;position:relative;z-index:1}.book-layout .book-icon-layout[data-v-a9d8ac56]{line-height:38px;width:100%;height:100%;text-align:center;border-radius:50%;background:#fff;overflow:hidden;position:relative}.book-layout .iconfont[data-v-a9d8ac56]{font-size:26px}.book-layout .book-list-layout[data-v-a9d8ac56]{max-width:300px;padding:7px 20px;background:#2d2d2d;position:absolute;left:100%;top:0;transition:.3s;-webkit-transform:scale(0);transform:scale(0);-webkit-transform-origin:0 15px;transform-origin:0 15px}.book-layout .book-list-layout .book-list-item-layout[data-v-a9d8ac56]{color:#fff;text-align:center}.book-layout .book-list-layout .book-list-item-layout .icon[data-v-a9d8ac56]{width:25px;height:25px;line-height:22px;border:1px solid #fff;border-radius:50%}.book-layout .book-list-layout .book-list-item-layout .icon .iconfont[data-v-a9d8ac56]{font-size:16px}.book-layout .book-list-layout .book-list-item-layout .book-name[data-v-a9d8ac56]{font-size:12px;margin-left:10px}.book-layout .book-list-layout .book-list-item-layout[data-v-a9d8ac56]:not(:last-child){margin-bottom:10px}.book-layout .book-list-layout .book-list-item-layout.act .icon[data-v-a9d8ac56]{border:1px solid #398dee;background:#398dee}.show-book-list:hover .book-list-layout[data-v-a9d8ac56]{-webkit-transform:scale(1);transform:scale(1)}.book-layout.act[data-v-a9d8ac56]{-webkit-transform:scale(1.2);transform:scale(1.2)}.book-layout.act .book-icon-layout[data-v-a9d8ac56]{background:#398dee}.book-layout.act .book-icon-layout .iconfont[data-v-a9d8ac56]{color:#fff}.book-layout[data-v-a9d8ac56]:not(:last-child){margin-bottom:10px}.catalog-layout[data-v-a9d8ac56]{padding:15px 2px;overflow:auto;background:#2d2d2d;color:#919191;width:200px;max-width:200px;transition:.3s}.hidden-catalog[data-v-a9d8ac56]{padding:15px 0;max-width:0;overflow:hidden}",""])},431:function(t,e,o){"use strict";o.r(e);var n=o(85),r=(o(29),o(115),o(61),o(11),o(84),o(20),o(2)),c=o(4),l=o(21),d=o(5),f=o(3),h=o(83),m=o(33),v=(o(40),{name:"TreeItem",props:{curNode:{type:Object,require:!0},isNewDir:{type:Boolean,default:function(){return!1}}},data:function(){return{renameCatalog:!1,operateMenuStyle:{left:-1,top:"50%"},renameValue:"",newDir:{parentId:"",name:"新建文件夹",show:!1,isNew:!0},isOpen:!1}},computed:Object(c.a)({},Object(l.e)({catalogs:function(t){return t.catalogs.list},actCatalog:function(t){return t.catalogs.curCatalog},schemaList:function(t){return Object.values(t.schema.list).filter(function(t){return t.fields.length})},curBook:function(t){return t.books.curBook}}),Object(l.c)("catalogs",["treeChainList"]),{hasChild:function(){return this.catalogs[this.curNode._id]&&this.catalogs[this.curNode._id].childNodes&&this.catalogs[this.curNode._id].childNodes.length}}),watch:{curNode:{handler:function(){this.getDate()},deep:!0}},methods:Object(c.a)({},Object(l.d)("catalogs",[d.CATALOGS_CUR_SAVE,d.CATALOGS_TEMPLATE_CREATE]),Object(l.b)("catalogs",[f.CATALOGS_GET,f.CATALOGS_PUT,f.CATALOGS_POST,f.CATALOGS_DELETE]),Object(l.b)("articles",[f.ARTICLE_RECENTLY_LIST_GET]),{toggleOpenDir:function(){this.isOpen=!this.isOpen},chooseCatalog:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.isOpen=!0,this[d.CATALOGS_CUR_SAVE](this.curNode._id),h.a.$emit("emitFromCatalog",e||Object(c.a)({},this.curNode,{catalogId:this.curNode._id}));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getRecentlyArticles:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$showLoading(),t.next=3,this[f.ARTICLE_RECENTLY_LIST_GET]();case 3:this.$hideLoading(),this[d.CATALOGS_CUR_SAVE]("recently");case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),showOperateMenu:function(t){if(!this.curNode.icon){var e=t.clientX,o=t.clientY;this.operateMenuStyle={top:"".concat(o,"px"),left:"".concat(e,"px")}}},closeMenu:function(){this.operateMenuStyle.left=-1},todoRename:function(){this.renameValue=this.curNode.name,this.closeMenu(),this.renameCatalog=!0},todoCreateFile:function(t){this.chooseCatalog({schemaId:t._id,catalogId:this.curNode._id,isNew:!0}),this.closeMenu()},todoDelete:function(){var t=this;this.closeMenu(),this.$alert({title:'你确认要删除"'.concat(this.curNode.name,'"')}).then(function(){var e=Object(r.a)(regeneratorRuntime.mark(function e(o){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.doDeleteCatalog();case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},doDeleteCatalog:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$showLoading(),t.next=3,this[f.CATALOGS_DELETE]({_id:this.curNode._id});case 3:if(e=t.sent,this.$hideLoading(),e.err){t.next=9;break}return this.$toast({title:"删除成功"}),t.next=9,this.getDate(this.curNode,!0);case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),doRename:function(){this.renameCatalog=!1,this.isNewDir?this.addCatalog(this.renameValue,this.curNode.parentId):this.renameValue&&this.renameValue!==this.curNode.name&&this.modifyCatalogName(this.renameValue,this.curNode)},submitCatalogName:function(t,e){e.isNew?this.addCatalog(t,e):this.modifyCatalogName(t,e)},modifyCatalogName:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o._id,r=o.parentId,t.next=3,this[f.CATALOGS_PUT]({_id:n,name:e,parentId:r});case 3:t.sent.err||this.getDate(o,!0);case 5:case"end":return t.stop()}},t,this)}));return function(e,o){return t.apply(this,arguments)}}(),addCatalog:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this[f.CATALOGS_POST]({parentId:o,name:e,bookId:this.curBook});case 2:t.sent,this.$emit("emitExitNewDir");case 4:case"end":return t.stop()}},t,this)}));return function(e,o){return t.apply(this,arguments)}}(),exitNewDir:function(){this.getDate(this.curNode,!0),this.newDir.parentId=""},doCreateTemDir:function(){this.isOpen=!0,this.closeMenu(),this.newDir.parentId=this.curNode._id,this.newDir.parentParentId=this.curNode.parentId},getDate:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e||this.curNode,t.next=3,this[f.CATALOGS_GET]({parentId:o?n.parentId||"root":n._id,bookId:this.curBook});case 3:case"end":return t.stop()}},t,this)}));return function(e,o){return t.apply(this,arguments)}}(),init:function(){var t=this;this.isNewDir?this.todoRename():this.curNode.hasChild&&this.getDate(),document.addEventListener("click",function(e){t.$el.contains(e.target)})}}),mounted:function(){this.init()}}),x=(o(229),o(8)),_={name:"Tree",components:{TreeItem:Object(x.a)(v,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"catalogs-layout"},[o("div",{staticClass:"flex align-items-center catalogs-item-layout",class:{act:t.actCatalog===t.curNode._id,"catalogs-item-hover":!(t.isNewDir||t.renameCatalog)},on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:t.chooseCatalog(null)},contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),o=e,t.showOperateMenu(o);var o}}},[t.catalogs[t.curNode._id]&&t.hasChild?o("div",{staticClass:"has-child",class:{"in-chain":t.isOpen||t.isOpen&&t.hasChild&&t.treeChainList&&t.treeChainList.indexOf(t.curNode._id)>-1},on:{click:function(e){return e.stopPropagation(),t.toggleOpenDir(e)}}}):t._e(),t._v(" "),t.curNode.icon?o("i",{staticClass:"iconfont",class:t.curNode.icon,attrs:{id:t.curNode._id}}):t.treeChainList&&t.treeChainList.indexOf(t.curNode._id)>-1?o("i",{staticClass:"iconfont icon-wenjianjia",class:t.curNode.icon,attrs:{id:t.curNode._id}}):o("i",{staticClass:"iconfont icon-wendang1",attrs:{id:t.curNode._id}}),t._v(" "),t.curNode.isNew||t.renameCatalog?o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.renameValue,expression:"renameValue",modifiers:{trim:!0}},{name:"focus",rawName:"v-focus:select",arg:"select"}],staticClass:"edit-catalogs-input line-ellipsis",domProps:{value:t.renameValue},on:{blur:[t.doRename,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.renameValue=e.target.value.trim())}}}):o("div",{staticClass:"catalogs-name line-ellipsis"},[t._v(t._s(t.curNode.name))]),t._v(" "),t.curNode.icon?t._e():o("div",{staticClass:"operate-triangle-btn",on:{click:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.stopPropagation(),o=e,t.showOperateMenu(o));var o}}},[o("i",{staticClass:"iconfont icon-tianjiajiahaowubiankuang"})]),t._v(" "),-1!==t.operateMenuStyle.left?o("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeMenu,expression:"closeMenu"}],staticClass:"catalog-operate-layout",style:t.operateMenuStyle},[o("div",{staticClass:"catalog-operate-item hadChild"},[t._v("\n        新建文件\n        "),o("div",{staticClass:"operate-item-child"},t._l(t.schemaList,function(e,n){return o("div",{staticClass:"catalog-operate-item",class:{builtIn:e.builtIn},on:{click:function(o){return o.stopPropagation(),t.todoCreateFile(e)}}},[t._v(t._s(e.name))])}),0)]),t._v(" "),o("div",{staticClass:"catalog-operate-item",on:{click:function(e){return e.stopPropagation(),t.doCreateTemDir(e)}}},[t._v("新建文件夹")]),t._v(" "),"root"!==t.curNode._id?o("div",{staticClass:"catalog-operate-item",on:{click:function(e){return e.stopPropagation(),t.todoRename(e)}}},[t._v("重命名")]):t._e(),t._v(" "),"root"!==t.curNode._id?o("div",{staticClass:"catalog-operate-item",on:{click:function(e){return e.stopPropagation(),t.todoDelete(e)}}},[t._v("删除")]):t._e()]):t._e()]),t._v(" "),t.catalogs[t.curNode._id]&&t.catalogs[t.curNode._id].childNodes&&t.catalogs[t.curNode._id].childNodes.length?o("div",t._l(t.catalogs[t.curNode._id].childNodes,function(e,n){return o("TreeItem",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],key:n,attrs:{curNode:e}})}),1):t._e(),t._v(" "),t.newDir.parentId===t.curNode._id?o("TreeItem",{attrs:{curNode:t.newDir,isNewDir:t.newDir.parentId===t.curNode._id},on:{emitExitNewDir:t.exitNewDir}}):t._e()],1)},[],!1,null,"7c521a1c",null).exports},data:function(){return{catalogList:[{_id:m.a.recentlyArticlesKey,name:"最近文档",hasChild:!1,icon:"icon-wendang"},{_id:"root",name:"我的文件夹",hasChild:!0}]}}},w=Object(x.a)(_,function(){var t=this.$createElement,e=this._self._c||t;return e("div",this._l(this.catalogList,function(t,o){return e("TreeItem",{key:t._id,attrs:{curNode:t,treeChain:[t._id]}})}),1)},[],!1,null,"04184fe2",null).exports,y={props:{list:{type:Array,default:function(){return[]}},cusArticle:""},data:function(){return{filterKeys:""}},computed:Object(c.a)({},Object(l.e)({showBrief:function(t){return t.config.showBrief},bookList:function(t){return t.books.list},schemaList:function(t){return t.schema.list},filterList:function(){var t=this;return this.filterKeys?this.list.filter(function(e){return e.title.indexOf(t.filterKeys)>-1}):this.list}})),filters:{getBookName:function(t,e){return e[t]?e[t].name:""},getCatalogsName:function(t,e){return e[t]?e[t].name:""}},methods:Object(c.a)({},Object(l.b)("articles",[f.ARTICLE_DELETE]),{chooseArticles:function(t){this.$emit("emitToChooseCurArticle",{schemaId:t.schemaId,articleId:t._id,catalogId:t.catalogId})},todoDelete:function(t){var e=this;this.$alert({title:'你确认要删除"'.concat(t.title,'"')}).then(function(){var o=Object(r.a)(regeneratorRuntime.mark(function o(n){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n&&e.doDeleteArticle(t);case 1:case"end":return o.stop()}},o)}));return function(t){return o.apply(this,arguments)}}())},doDeleteArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},this.$showLoading(),t.next=4,this[f.ARTICLE_DELETE](e._id);case 4:o=t.sent,this.$hideLoading(),o.err||this.$toast({title:"删除成功"}),this.$emit("emitInitArticle",{schemaId:e.schemaId,catalogId:e.catalogId});case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()})},C=(o(231),Object(x.a)(y,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout box-shadow flex direction-column",class:{"hidden-article":!t.showBrief}},[o("div",{staticClass:"flex-1 flex direction-column article-min-width"},[o("div",{staticClass:"article-layout-input-box align-items-center"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.filterKeys,expression:"filterKeys"}],staticClass:"article-layout-input",attrs:{type:"text"},domProps:{value:t.filterKeys},on:{input:function(e){e.target.composing||(t.filterKeys=e.target.value)}}}),t._v(" "),o("i",{staticClass:"iconfont icon-sousuo"})]),t._v(" "),o("div",{staticClass:"flex-1 article-item-box"},t._l(t.filterList,function(e,n){return o("div",{key:n,staticClass:"article-item",class:{act:e._id===t.cusArticle},on:{click:function(o){return t.chooseArticles(e)}}},[o("div",{staticClass:"article-item-title"},[t._v(t._s(e.title))]),t._v(" "),o("div",{staticClass:"article-label"},[o("span",{staticClass:"article-label-item"},[t._v(t._s(t._f("getBookName")(e.bookId,t.bookList)))]),t._v(" "),o("span",{staticClass:"article-label-item"},[t._v(t._s(t._f("getCatalogsName")(e.schemaId,t.schemaList)))])]),t._v(" "),o("div",{staticClass:"article-item-mark"},[t._v(t._s(t._f("timestampToBriefTime")(e.createTime))+"~"+t._s(t._f("timestampToBriefTime")(e.updateTime)))]),t._v(" "),o("div",{staticClass:"operate-icon",on:{click:function(o){return o.stopPropagation(),t.todoDelete(e)}}},[o("i",{staticClass:"iconfont icon-shanchu1"})])])}),0)])])},[],!1,null,"29585472",null).exports),k=(o(62),o(63),o(41),{props:["fields","contentList","curContentId"],filters:{},computed:{findDone:function(){return this.fields.find(function(t){return t.isDone})}},methods:{textareaFormat:function(t){return t?t.replace(/\n|\r\n/g,"<br>"):""},todoAddContent:function(){this.$emit("focusContent")},focusContent:function(t){this.$emit("focusContent",Object(c.a)({},t))},todoDelete:function(t){var e=this;this.$alert({title:"你确认要删除此内容"}).then(function(){var o=Object(r.a)(regeneratorRuntime.mark(function o(n){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:n&&e.$emit("emitDeleteItem",Object(c.a)({},t));case 1:case"end":return o.stop()}},o)}));return function(t){return o.apply(this,arguments)}}())}}}),I=(o(233),Object(x.a)(k,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-list  flex flex-1 direction-column"},[o("div",{staticClass:"flex-1 relative"},[o("div",{staticClass:"absolute-full scroll-auto"},t._l(t.contentList,function(e,n){return t.contentList&&t.contentList.length?o("div",{key:n,staticClass:"content-list-item",class:{act:t.curContentId===e._id},on:{click:function(o){return t.focusContent(e)}}},[o("div",{staticClass:"operate-icon",on:{click:function(o){return o.stopPropagation(),t.todoDelete(e)}}},[o("i",{staticClass:"iconfont icon-shanchu1"})]),t._v(" "),t.fields&&t.fields.length?o("div",{staticClass:"form-layout theme-1"},t._l(t.fields,function(n,r){return o("div",{staticClass:"form-group flex",class:"content-list-"+r,attrs:{index:r}},[o("div",{staticClass:"form-label-layout"},[t._v("\n             "+t._s(n.name)+"：\n           ")]),t._v(" "),"markdown"===n.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout markdown-layout"},[t._v("\n             "+t._s(e[n._id]||"无")+"\n           ")]):t._e(),t._v(" "),"input"===n.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout"},[t._v("\n             "+t._s(e[n._id]||"无")+"\n           ")]):t._e(),t._v(" "),"textarea"===n.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout",domProps:{innerHTML:t._s(t.textareaFormat(e[n._id]))}}):t._e(),t._v(" "),"radio"===n.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout"},[t._l(n.options,function(r,c){return r.id===e[n._id]?o("div",{staticClass:"add-options-item",class:{act:r.id===e[n._id]}},[t._v("\n               "+t._s(r.name)+"\n             ")]):t._e()}),t._v(" "),e[n._id]?t._e():o("div",[t._v("无")])],2):t._e(),t._v(" "),"select"===n.type?o("div",{staticClass:" form-content-layout flex flex-1 align-items-center "},[t._l(n.options,function(r,c){return"[object Array]"===Object.prototype.toString.call(e[n._id])&&e[n._id].indexOf(r.id)>-1?o("div",{class:{act:"[object Array]"===Object.prototype.toString.call(e[n._id])&&e[n._id].indexOf(r.id)>-1}},[o("div",{staticClass:" flex align-items-center"},[o("div",[t._v(t._s(r.name))])])]):t._e()}),t._v(" "),e[n._id]&&e[n._id].length?t._e():o("div",[t._v("无")])],2):t._e(),t._v(" "),t.findDone&&t.findDone._id===n._id?o("div",{staticClass:"is-done-layout",class:{"is-done-y":t.findDone.isDone===e[n._id]}},[t.findDone.isDone===e[n._id]?o("div",[t._v("Y")]):o("div",[t._v("N")])]):t._e()])}),0):t._e()]):t._e()}),0)]),t._v(" "),o("div",{staticClass:"add-content-box",class:{act:"new"===t.curContentId},on:{click:t.todoAddContent}},[t._v("添加内容")])])},[],!1,null,"13d188fb",null).exports),O=o(235),L=o.n(O),A=o(236),E=o.n(A);L.a.setOptions({renderer:new L.a.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(code){return E.a.highlightAuto(code).value}});var T={model:{prop:"data",event:"update"},props:{data:String},data:function(){return{split:.5,markDownValue:"",editMode:1,isEdit:!0,isPreview:!0,markdownHTML:""}},watch:{markDownValue:function(t){this.markdownHTML=L()(t),this.$emit("update",t)}},methods:{toggleEdit:function(){this.isEdit=!this.isEdit,this.isEdit||(this.isPreview=!0)},togglePreview:function(){this.isPreview=!this.isPreview,this.isPreview||(this.isEdit=!0)}},mounted:function(){this.markDownValue=this.data||""}},N=(o(423),Object(x.a)(T,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"code-mirror absolute-full flex direction-column markdown-layout"},[o("div",{staticClass:"flex-1 flex relative",class:{hideSplit:3!==t.editMode}},[o("div",{staticClass:"markdown-operate-layout"},[o("div",{staticClass:"icon-layout",class:{act:t.isEdit},on:{click:t.toggleEdit}},[o("i",{staticClass:"iconfont icon-bianji2"})]),t._v(" "),o("div",{staticClass:"icon-layout",class:{act:t.isPreview},on:{click:t.togglePreview}},[o("i",{staticClass:"iconfont icon-yulan"})])]),t._v(" "),t.isEdit?o("div",{staticClass:"flex-1 relative"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.markDownValue,expression:"markDownValue"}],staticClass:"markdown-edit-box box-shadow-inset",domProps:{value:t.markDownValue},on:{input:function(e){e.target.composing||(t.markDownValue=e.target.value)}}})]):t._e(),t._v(" "),t.isPreview?o("div",{staticClass:"flex-1 md-body-layout edit-layout relative"},[o("div",{staticClass:"markdown-style",domProps:{innerHTML:t._s(t.markdownHTML)}})]):t._e()])])},[],!1,null,"1b621aae",null).exports),R={props:{editMeta:{type:Object}},data:function(){return{articleName:"未命名",cacheName:"未命名",contents:{},editId:"new",schemaId:"",catalogId:"",test:"123",fields:[],contentList:[],cacheContents:{},isEditContents:!1,showList:!1,showEditContent:!1}},components:{MarkdownEdit:N,articleContentList:I},computed:Object(c.a)({},Object(l.e)({catalogs:function(t){return t.catalogs.list},bookList:function(t){return t.books.list},articles:function(t){return t.articles.list}}),{dataHasChange:function(){return JSON.stringify(this.contents)!==JSON.stringify(this.cacheContents)}}),watch:{editMeta:function(t){this.setMeta(t)},editId:function(t){this[d.ARTICLE_CUS_SAVE](t)}},methods:Object(c.a)({},Object(l.d)("articles",[d.ARTICLE_CUS_SAVE]),Object(l.d)("books",[d.BOOK_CUR_UPDATE]),Object(l.b)("articles",[f.ARTICLE_DES_GET,f.ARTICLE_POST,f.ARTICLE_PUT,f.ARTICLE_CONTENT_PUT,f.ARTICLE_CONTENT_POST,f.ARTICLE_CONTENT_DELETE]),{setMeta:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,r,c,l,content,title,d,f=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=e.editId,r=e.fields,c=e._id,l=e.catalogId,content=e.content,title=e.title,d=e.list,this.editId=o,this.schemaId=c,this.catalogId=l,(this.articleName="new"===o||!d)&&(this.fields=[]),setTimeout(function(){f.getContentList(),f.cacheName=f.articleName="new"===o?"未命名":title,f.showList=d||!1,f.contents=f.initContent(f.fields,content),f.cacheContents=JSON.parse(JSON.stringify(f.contents)),f.fields=Object(n.a)(r)});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),initContent:function(t,e){return t&&t.length&&t.forEach(function(t){e[t._id]||(e[t._id]=t.default?t.default:"")}),e},todoEditContent:function(t){this.showEditContent=!0;var content=t||{_id:"new"},e={editId:this.editId,_id:this.schemaId,catalogId:this.catalogId,fields:this.fields,title:this.articleName,list:this.showList,content:content};this.setMeta(e)},doDeleteContent:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$showLoading(),t.next=3,this[f.ARTICLE_CONTENT_DELETE]({articleId:this.editId,contentId:e._id});case 3:o=t.sent,this.$hideLoading(),o.err||(this.$toast({title:"删除成功"}),this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:this.editId}));case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getContentList:function(){if("new"!==this.editId){var data=this.articles[this.editId].contents;return this.contentList=Object(n.a)(data),data}this.contentList=[]},changeSelect:function(t,e){"[object Array]"!==Object.prototype.toString.call(this.contents[t])&&(this.contents[t]=[]);var o=this.contents[t].indexOf(e.id);o>-1?this.contents[t].splice(o,1):(Object(n.a)(this.contents[t]).push(e.id),this.contents[t].push(e.id),this.contents=JSON.parse(JSON.stringify(this.contents)))},toggleList:function(){this.showList=!this.showList,this.articleName||(this.articleName=this.cacheName),this.todoEdit(!0)},todoEdit:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o.length>0&&void 0!==o[0]&&o[0]){t.next=4;break}if(this.articleName&&"new"!==this.editId&&this.cacheName!==this.articleName){t.next=4;break}return t.abrupt("return");case 4:return this.$showLoading(),t.next=7,this[f.ARTICLE_PUT]({_id:this.editId,content:this.contents,title:this.articleName,list:this.showList});case 7:if(t.sent.err){t.next=14;break}return this.$toast({title:"保存成功"}),e=this.editId,t.next=13,this.getData(e,!0);case 13:this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:e,getData:"getArticleByCatalogId"});case 14:this.$hideLoading();case 15:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),todoSave:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.articleName){t.next=2;break}return t.abrupt("return");case 2:return this.$showLoading(),t.next=5,this[f.ARTICLE_POST]({schemaId:this.schemaId,catalogId:this.catalogId,content:this.contents,title:this.articleName});case 5:if((e=t.sent).err){t.next=12;break}return this.$toast({title:"添加成功"}),o=e.data.id,t.next=11,this.getData(o,!0);case 11:this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:o,getData:"getArticleByCatalogId"});case 12:this.$hideLoading();case 13:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=l.length>1&&void 0!==l[1]&&l[1],this.editId=e,this.$showLoading(),t.next=5,this[f.ARTICLE_DES_GET]({_id:e,force:o});case 5:(n=t.sent).err||(r=n.data,c=r.bookId,r.catalogId,void 0,this[d.BOOK_CUR_UPDATE](c)),this.$hideLoading();case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),toDoSaveArticleContent:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e,o,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.dataHasChange&&"new"!==this.editId){t.next=2;break}return t.abrupt("return");case 2:if(this.isEditContents=!1,this.$showLoading(),e="",o="","new"!==this.contents._id){t.next=12;break}return t.next=9,this[f.ARTICLE_CONTENT_POST]({_id:this.editId,content:this.contents});case 9:o=t.sent,t.next=16;break;case 12:return t.next=14,this[f.ARTICLE_CONTENT_PUT]({_id:this.editId,content:this.contents});case 14:o=t.sent,e=this.contents._id;case 16:this.$hideLoading(),o.err||(n="new"===this.contents._id?"添加成功":"保存成功",this.$toast({title:n})),this.$emit("emitUpdateArticle",{schemaId:this.schemaId,catalogId:this.catalogId,articleId:this.editId,contentId:e});case 19:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),init:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.$route.params.id)){t.next=5;break}return this.editId=e,t.next=5,this.getData(e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),mounted:function(){this.init()}},article=(o(425),Object(x.a)(R,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"article-layout flex direction-column flex-1",class:t.editMeta._id},[o("div",{staticClass:"article-title flex "},[o("div",{staticClass:"flex-1 schema-title-layout relative"},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.articleName,expression:"articleName",modifiers:{trim:!0}}],staticClass:"full-input",domProps:{value:t.articleName},on:{blur:[function(e){return t.todoEdit(!1)},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.articleName=e.target.value.trim())}}})]),t._v(" "),o("div",{staticClass:"schema-operate"},["new"===t.editId?o("span",{staticClass:"schema-operate-btn",class:{"disable-btn":!t.articleName},on:{click:t.todoSave}},[t._v("保存")]):o("div",{staticClass:"operate-list-operate"},[t.showList?o("div",{staticClass:"icon-box",class:{act:t.showEditContent},on:{click:function(e){e.stopPropagation(),t.showEditContent=!t.showEditContent}}},[o("i",{staticClass:"iconfont icon-zuoye1"})]):t._e(),t._v(" "),o("div",{staticClass:"icon-box",class:{act:t.showList},on:{click:function(e){return e.stopPropagation(),t.toggleList(e)}}},[o("i",{staticClass:"iconfont icon-liebiao3"})])])])]),t._v(" "),o("div",{staticClass:"flex-1 flex"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showList&&t.showEditContent||!t.showList,expression:"(showList&&showEditContent)||!showList"},{name:"click-outside",rawName:"v-click-outside",value:t.toDoSaveArticleContent,expression:"toDoSaveArticleContent"}],staticClass:"article-content relative flex-1 flex",class:{noSave:t.dataHasChange},on:{click:function(e){t.isEditContents=!0},keydown:function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.toDoSaveArticleContent(e)):null}}},[o("div",{staticClass:"flex-1 relative"},[o("div",{staticClass:"scroll-box"},[t.fields&&t.fields.length?o("div",{staticClass:"form-layout theme-1"},t._l(t.fields,function(e,n){return o("div",{staticClass:"form-group flex direction-column",attrs:{index:n}},[o("div",{staticClass:"form-label-layout"},[t._v("\n                "+t._s(e.name)+"：\n              ")]),t._v(" "),"markdown"===e.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout markdown-layout"},[o("markdown-edit",{model:{value:t.contents[e._id],callback:function(o){t.$set(t.contents,e._id,o)},expression:"contents[field._id]"}})],1):t._e(),t._v(" "),"input"===e.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.contents[e._id],expression:"contents[field._id]"}],staticClass:"form-input",attrs:{placeholder:"填写"+e.name},domProps:{value:t.contents[e._id]},on:{input:function(o){o.target.composing||t.$set(t.contents,e._id,o.target.value)}}})]):t._e(),t._v(" "),"textarea"===e.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.contents[e._id],expression:"contents[field._id]"}],staticClass:"form-input",attrs:{type:"text"},domProps:{value:t.contents[e._id]},on:{input:function(o){o.target.composing||t.$set(t.contents,e._id,o.target.value)}}})]):t._e(),t._v(" "),"radio"===e.type?o("div",{staticClass:"flex flex-1 align-items-center form-content-layout"},t._l(e.options,function(n,r){return o("div",{staticClass:"add-options-item radio-style",class:{act:n.id===t.contents[e._id]}},[t._v("\n                  "+t._s(n.name)+"\n                  "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.contents[e._id],expression:"contents[field._id]"}],staticClass:"form-radio",attrs:{type:"radio"},domProps:{value:n.id,checked:t._q(t.contents[e._id],n.id)},on:{change:function(o){return t.$set(t.contents,e._id,n.id)}}})])}),0):t._e(),t._v(" "),"select"===e.type?o("div",{staticClass:" form-content-layout form-content-layout-select"},t._l(e.options,function(n,r){return o("div",{staticClass:"select-style",class:{act:"[object Array]"===Object.prototype.toString.call(t.contents[e._id])&&t.contents[e._id].indexOf(n.id)>-1}},[o("div",{staticClass:" flex align-items-center"},[t._m(0,!0),t._v(" "),o("div",[t._v(t._s(n.name))])]),t._v(" "),o("input",{key:n.id,staticClass:"form-radio",attrs:{type:"checkBox"},domProps:{value:n.id},on:{change:function(o){return t.changeSelect(e._id,n)}}})])}),0):t._e()])}),0):t._e()])])]),t._v(" "),t.showList?o("div",{staticClass:"flex flex-1 relative"},[o("article-content-list",{attrs:{fields:t.fields,contentList:t.contentList,curContentId:t.contents._id},on:{focusContent:t.todoEditContent,emitDeleteItem:t.doDeleteContent}})],1):t._e()])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"select-iconfont"},[e("i",{staticClass:"iconfont icon-gou"})])}],!1,null,"39d30912",null).exports),D={name:"articleFixed",computed:Object(c.a)({},Object(l.e)({showDir:function(t){return t.config.showDir},showBrief:function(t){return t.config.showBrief}})),methods:Object(c.a)({},Object(l.d)("config",[d.CONFIG_TOGGLE_SAVE]),{doSetConfig:function(t){this[d.CONFIG_TOGGLE_SAVE]({tar:t,val:!this[t]})}}),mounted:function(){window.localStorage.getItem("showDir"),window.localStorage.getItem("showBrief")}},j=(o(427),{components:{TreeItem:w,ArticleBrief:C,articles:article,articleFixed:Object(x.a)(D,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"controller-layout-fixed"},[o("div",{staticClass:"controller-layout-item",class:{act:t.showDir},on:{click:function(e){return e.stopPropagation(),t.doSetConfig("showDir",!t.showDir)}}},[o("i",{staticClass:"iconfont icon-neirong"})]),t._v(" "),o("div",{staticClass:"controller-layout-item",class:{act:t.showBrief},on:{click:function(e){return e.stopPropagation(),t.doSetConfig("showBrief",!t.showBrief)}}},[o("i",{staticClass:"iconfont icon-shujia1"})])])},[],!1,null,"5b592daa",null).exports},data:function(){return{editMeta:{editId:""},curArticleList:[],cusArticle:""}},computed:Object(c.a)({},Object(l.e)({schemaList:function(t){return t.schema.list},articleList:function(t){return t.articles.catalogMapArticles},curBook:function(t){return t.books.curBook},articles:function(t){return t.articles.list},showDir:function(t){return t.config.showDir}}),Object(l.c)("catalogs",["treeChainList"])),methods:Object(c.a)({},Object(l.d)("catalogs",[d.CATALOGS_CUR_SAVE]),Object(l.b)("books",[f.BOOK_LIST_GET]),Object(l.b)("schema",[f.SCHEMA_LIST_GET]),Object(l.b)("articles",[f.ARTICLE_RECENTLY_LIST_GET,f.ARTICLE_LIST_GET,f.ARTICLE_DES_GET]),Object(l.b)("catalogs",[f.CATALOGS_GET]),{getBookData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Promise.all([this[f.BOOK_LIST_GET](),this[f.SCHEMA_LIST_GET](),this[f.CATALOGS_GET]({parentId:"root",bookId:this.curBook})]).then(function(){e[f.ARTICLE_RECENTLY_LIST_GET]().then(function(){e.doShowArticleFromCatalog({catalogId:m.a.recentlyArticlesKey})})}).catch(function(t){console.log("err",t),e.$alert({title:"getBookData",content:t.message})});case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),chooseCurArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=e.catalogId,n=e.schemaId,r=e.articleId,c=e.contentId,l=void 0===c?"":c,this.cusArticle=r,this.setEditMeta(o,n,r,l);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),doCreateArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.catalogId,n=e.schemaId,t.next=3,this.getArticleByCatalogId(o);case 3:this.setEditMeta(o,n,"new");case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),doUpdateArticle:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.catalogId,n=e.articleId,r=e.contentId,c=void 0===r?"":r,l=e.schemaId,d=e.getData,"getArticleByCatalogId"!==(void 0===d?"":d)){t.next=4;break}return t.next=4,this.getArticleByCatalogId(o);case 4:return t.next=6,this.getData(n,!0);case 6:this.chooseCurArticle({catalogId:o,schemaId:l,articleId:n,contentId:c});case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),doShowArticleFromCatalog:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n,r,c,l,d,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.catalogId,n=e.articleId,r=e.contentId,c=void 0===r?"":r,t.next=3,this.getArticleByCatalogId(o);case 3:this.curArticleList&&this.curArticleList.length&&(l=this.curArticleList[0],d=l.catalogId,f=l.schemaId,this.chooseCurArticle({catalogId:d,schemaId:f,articleId:n||this.curArticleList[0]._id,contentId:c}));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),setEditMeta:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o,n,r){var l,d,f,h,m,v,x,_;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o||this.$alert({title:"缺少schemaId",showCancel:!1}),void 0,l=this.schemaList[o],d=l.fields,t.next=6,this.initContent(n,d,r);case 6:if(f=t.sent,h=f.tempObj,m=f.editTitle,v=f.list,x=Object(c.a)({},l,{catalogId:e,editId:n,list:v,content:JSON.parse(JSON.stringify(h)),title:m}),!(_=this.validEditMata(x))){t.next=15;break}return this.$alert({title:"editMeta的内容有错",content:_}),t.abrupt("return");case 15:this.editMeta=x,this.cusArticle=n;case 17:case"end":return t.stop()}},t,this)}));return function(e,o,n,r){return t.apply(this,arguments)}}(),initContent:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e,o,n){var r,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0,r={},c="未命名",l=!1,"new"!==e){t.next=8;break}o&&o.length&&o.forEach(function(t){r[t._id]=t.default?t.default:""}),t.next=14;break;case 8:if(this.articles[e]){t.next=11;break}return t.next=11,this.getData(e);case 11:c=this.articles[e].title,l=this.articles[e].list,this.articles[e].contents&&this.articles[e].contents.length&&(r=n?this.articles[e].contents.find(function(t){return t._id===n}):this.articles[e].contents[0]);case 14:return t.abrupt("return",{tempObj:r,editTitle:c,list:l});case 15:case"end":return t.stop()}},t,this)}));return function(e,o,n){return t.apply(this,arguments)}}(),validEditMata:function(data){var t=data.editId,e=data.fields,o=data._id,n=data.catalogId,title=data.title;return t?title?Object.keys(e).length?o?n?null:"catalogId不能为空":"_id(article)不能为空":"fields无效:".concat(JSON.stringify(e)):"title不能为空":"editId不能为空"},getData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.length>1&&void 0!==n[1]&&n[1],this.editId=e,this.$showLoading(),t.next=5,this[f.ARTICLE_DES_GET]({_id:e,force:o});case 5:t.sent,this.$hideLoading();case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getArticleByCatalogId:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e!==m.a.recentlyArticlesKey){t.next=3;break}return this.setArticleBrief(),t.abrupt("return");case 3:if(this.curBook){t.next=6;break}return this.$alert({content:"缺少bookId",showCancel:!1}),t.abrupt("return");case 6:return this.$showLoading(),t.next=9,this[f.ARTICLE_LIST_GET]({bookId:this.curBook,catalogId:e});case 9:return o=t.sent,this.setArticleBrief(),this.$hideLoading(),t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),setArticleBrief:function(){if(!Object.keys(this.articleList).length)return this.curArticleList=[],void(this.editMeta.editId="");var t=this.treeChainList[this.treeChainList.length-1],e=t===m.a.recentlyArticlesKey?m.a.recentlyArticlesKey:"".concat(this.curBook,"_").concat(t),o=this.articleList[e];if(!o)return this.curArticleList=[],void(this.editMeta.editId="");this.curArticleList=Object(n.a)(o)},init:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this[d.CATALOGS_CUR_SAVE](m.a.recentlyArticlesKey),this.getBookData(),h.a.$on("emitToCreateArticle",function(t){e.doCreateArticle(t)}),h.a.$on("emitFromCatalog",function(t){t.isNew?e.doCreateArticle(t):e.doShowArticleFromCatalog(t)}),h.a.$on("updateCurBooks",function(){e[d.CATALOGS_CUR_SAVE](m.a.recentlyArticlesKey),e.getBookData()});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}),mounted:function(){this.init()}}),S=(o(429),Object(x.a)(j,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flex flex-1"},[o("div",{staticClass:"catalog-layout box-shadow",class:{"hidden-catalog":!t.showDir}},[o("TreeItem")],1),t._v(" "),o("ArticleBrief",{attrs:{list:t.curArticleList,cusArticle:t.cusArticle},on:{emitToChooseCurArticle:t.chooseCurArticle,emitInitArticle:t.doShowArticleFromCatalog}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.editMeta.editId,expression:"!editMeta.editId"}],staticClass:"flex-1"}),t._v(" "),o("articles",{directives:[{name:"show",rawName:"v-show",value:t.editMeta.editId,expression:"editMeta.editId"}],attrs:{editMeta:t.editMeta},on:{emitUpdateArticle:t.doUpdateArticle}}),t._v(" "),o("articleFixed")],1)},[],!1,null,"a9d8ac56",null));e.default=S.exports}}]);